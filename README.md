# Quick Start

This project is built on top fo Redwood.

## Setup

Clone the repo

We use Yarn as our package manager. To get the dependencies installed, run this command in the root directory:

```terminal
yarn install
yarn workspace api contentlayer
```

### .env File

The following items need to be added to the .env file in the project's root

```shell

DATABASE_URL
TEST_DATABASE_URL

TAILWIND_MODE=watch

AIRTABLE_API
AIRTABLE_RW_BASE

SESSION_SECRET

AUTH_REDIRECT_URI
```

Currently, the production database is being hosted on [Railway.](https://railway.app/)

### Fire it up

```terminal
yarn redwood dev
```

Your browser should open automatically to `http://localhost:8910` to see the web app. Server functions run on `http://localhost:8911` and are also proxied to `http://localhost:8910/.redwood/functions/*`.

## Workspaces

Redwood makes uses of [yarn workspaces](https://classic.yarnpkg.com/lang/en/docs/workspaces/). So, anytime you want to add a package, you need to make sure you're running adding it to the correct workspace.

```terminal
// adding the date-fns package to the frontend / web folder
yarn workspace web add date-fns
// or, adding the date-fns package to the backend / api folder
yarn workspace api add date-fns
```

## Content

All of the site's content is located inside the **content** folder, in the root of the  project directory.

```javascript
_ articles
_ faqs
_ legal
_ livestreams
_ podcasts
```

Anytime a change is made to the content, you need to run:

```terminal
yarn workspace add contentlayer
```

This will look at the **content** folder and generate JSON files for all the different data types inside **api/.contentlayer/generated**

Then, it will take all the **images** inside the **articles** folder and duplicate them, adding them to the **web/src/public/images** folder.

The **.contentlayer** folder is ignored by git, so anytime the project is added to a new server, you'll need to run this command again.

## Custom functions

Several custom functions have been created. When working locally, these can be accessed at localhost:8911/FUNCTION_NAME or localhost:8910/.redwood/functions/FUNCTION_NAME

## `mdx`

This can be accessed at **localhost:8911/mdx/CONTENT_TYPE**

Currently, **faqs** and **articles** are the only two content types the custom function accepts. Anything else will return an error.

This function will return a JSON (generated by [ContentLayer](https://www.contentlayer.dev/)) that contains all the MDX frontend matter and body copy for the corresponding data type.

## `airtable`

This can be accessed at **localhost:8911/airtable**

Through a form's `POST` method, you'll need to include `fullName` and `email`

These get added to AirTable sheet referenced in the `.env` file.

From there, a [Zap](http://zapier.com) adds the email to a form in [ConvertKit](http://convertkit). The user should receive a confirmation email for a double opt-in.

## Tooling and Plop

To make it easier to generate MDX files for all the site's content pieces, I've written some plop scripts to automate the process.

These template are located inside **plop-templates**

| `yarn plop article` | Generates an article and empty images folder inside **content/articles*
| `yarn plop faq` | Generates an faq inside **content/faqs** |

*I've stubbed out actions for creating a **livestream** and **podcast** template, but these haven't been implemented yet.*
